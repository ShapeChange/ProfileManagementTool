sudo: required
services:
- docker
language:
- node_js
node_js:
- '10'
cache:
  directories:
  - node_modules
before_install:
- mkdir -p docs/output
- mkdir -p docs/stylesheets
- wget https://raw.githubusercontent.com/interactive-instruments/asciidoctor-theme-ii/master/stylesheets/ii.css -O docs/stylesheets/ii.css
- docker pull asciidoctor/docker-asciidoctor
install:
- yarn installBuild && yarn installTest
script:
- yarn test && yarn build
after_success:
- docker build -t $REPO:$COMMIT .
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH
  ; fi`
- docker tag $REPO:$COMMIT $REPO:$TAG
- docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
- docker push $REPO
- docker run -v $TRAVIS_BUILD_DIR/docs:/documents/ --name asciidoc-to-html asciidoctor/docker-asciidoctor asciidoctor -D /documents/output -a stylesheet=ii.css -a stylesdir=/documents/stylesheets index.adoc
- cd docs/output &&  cp -R ../**/img ./
- git init && git config user.name "${GH_USER_NAME}" && git config user.email "{GH_USER_EMAIL}"
- git add . ; git commit -m "Deploy to GitHub Pages"
- git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:gh-pages
env:
  global:
  - COMMIT=${TRAVIS_COMMIT::8}
  - REPO=iide/pmt
  - secure: nVGzC/kr83YuaGL4vLHTr2aYBJ7X9ag93vBiDmMFGmBI3zkLg7gIDSwkWbSQOWoY+lfS9nIHkDA2XwsEsyjksaFAqsKnZRJd+NGgpJoBP2F994WFaPcoRE89jXOBPwKHw8vzHPyRXKCvDPi7de82oQKYV6kDHxzMyd8MVQXKnaZOgjJg9jRP0n30ymD1WeXCyWIHOwwLvBr+DRcMngK+IUozFytqVzS1LXYaZR1qhipOpIwTOQhph5hl8/1F+gug7okmKBNh2GBJNDblp1fqjEk8RCMLvpEUEmnZbokq/zl9YHRFTotdM38AlOZrkdVE21Awj9XePAUUDOPzP6L0S71RWdCrN7Yw/Vt7ITonYea/5BlHiUKvsBJtd9xX+aNG8lP3+0rRSZpIesgHPbigj1OTSEmr6MdgMfoPIUr64N6gbPfMY1BKVo2fB1BnisjKX/yOer+HR3p65EevYTw5M5Y/j/cieEu3o22SXne2IT6UABpRHQ/ByVXzOym1JNA5qlGhu+zbyAZwQvKCZ7/g8ygU06lOiV3IF3IIgvV7bwdm8M2gOuCMUk4kH3qTOxP/40rhoHr/7R/vkn9oExe7C4DzPI3euUC1tR7x/0QnWhIq0UYiOaPOCtB6i7oQirfJ3GYAwZBU+nXDgcNVWH4ODOtnUgo4KWCD5MBPGQS6duo=
  - secure: ml3WRHpcI+aO9neikRGBm6eoKxXeGP3WIhkH7hrwIqC0ssW3VBzvQdyUWrymHFJEh79Mja6ZV7rnh8FAAuKDl82+euK9gJtftLSYkdpjyAyvYX7WCEGoLO7Gkg3abwPXUNJuc2t6GbCuANZGOdZ/Yxxsyqj557A+gdfmPxP/Am3TDSbilCjYxc3Y80DtuPaaF3ytuQ22vSWhDiWZJVmFaR1aL1lCq5xKkFXpoS/VPbf0Vb3/yExUBFj8fywCCNBq4pN6o9K0wcP7Y4jYdZRNhhYOQWQFz4zWz7o4Q//4LeyfcoSwvkIq6dLTluIm/aFZPtJt5BblTavbAzu/Eel8HNngMEXmq7NRYPVioxgZKEiu7Vlx6WSLL2tkTnDqafCZk4ymyhazB3pTbBLkd36RD9C1mciH+PCaoEtkUpWG+OTu0iuB7QoV8tbsjsbvCPwkeoq4Q5u8+YvK8LPPF5VEJn04P12IwBUlJc2civ/36tMtO6H1yvWSRMYByzztAsKyUMvmzc0V4D4vP/i7GwTgtey4QtguOKqbJcHSVHchfdZCkwJdU5XFr4R7u6/R+ZnVf7abHrKyt+8OqHrALrYDq5ZCfGlindtFFS1oBWw9brp+Yx3s60oCIY32sBc5wDT6PxLB8z1zSFAjF2S8sDLkiYBy36j20zVJNwdSz9RPiFo=
  - secure: M1ky8fN+v/6KbM3ON2whdVolS4whsgek+Z5SWW6niSBTwxJ52vWj9uymz5NF7NhIrjCFHsY80t9cz3cN/puZ7i5iexvg+3PYK6TE8x5qMg/myBIihaJ5ITCSdXO/nYe0hSnNSjJIXFJxF70P7mqclMpdgBBusQEH8JGKfN++l7/8zbbKWORcqpNID9Mui4AGa1oH3+j7z78FktX5JvW5u71n8XTcT4wu9zZ7c9smRzVYGpMOM183b3Nhtdk+H2Xv5YUI+/8z7PyG0s8Oiuqa3Mgu2u352OUEAdkOjw5X8jKzxXhmduSCIGyg2ceAXSaBCB69FnGQlu6L8ZloEv8RUEAaScaAQR9OmY4M0/xQs7gEZMvqu4JqFjTRkrWRvnerx7eoHrEZCQ4jTqSqdoiPnuR2B3Oa98BohgI9HlmbtxIZba07/nyNIkOyDqwUM1jknHrBW74tVper9otEXYkegKdJBYoPhKx2uApKMPMPj5TZCx/fv+699r32RyXRzWU7tmZx5gsq7Py8Esz1A+fsl9Vw7qVMThn5zs97QX+MYhY2diQ18ZQ0lLEONKlfN3yMqy0iOcQfxY8XZs+Ao+m+6M5Z7gSvXLbeL8+ZZ3VgFPjzfvz6tkDWtigxf3xrE+TEuun3AMZkA0FoyH/OOSi5OBg3fyFZszFmOER0UE9bHzQ=
  - secure: Tp2C9WmQqsDUFjjH1RJSk+WDZ6YViduAHNxngzNFWwkTVo40cxsbwDo23JnR5yBudGkTm1lnADl/SyvM2cnWFNr3EPuGSzWnUqc4ng4yI0CHanlbbKB7toKKvUtTT/NpZfjLJmrJM0NE5TMpQ/rzEHzJhPigANVrQTKoLZ/vkgeHpNI5a4ZoTZGuwxt7fNoYP8pP16UbnSCvJXzqCTB/rQFzVjVFnbCb1x+kaQ4oExJEpVqbSi3HTpdeop75eZm0F7pRIgWiCwpBADGNvzVktQWeQQbzQ/2Lt9qw4UlP4Zh4tozx1Lq898PCPZdplG3b0Z+jF+o59PegZKfyDji7JaRL2p+ACgNOP+EcYD7yegypsX8bJQntaylFVuVPWskEVZb/ixOo8+C7P8vr6lY+u0M5Ul56c4raP8qpeg6CpEPEDFFy+VzGk/T4FOzoDpYlw+69/qma3Z6J92YTai30vMJl0cco4bnGrGcyxiZSS5ebQVKJhxsetvVG5AhPZTJK2zcsdih12ay9zqh1VkqDYcQfn8rBe8ZvAStlMu07pAsawK3cWBCAmHGtrHabxOncgtNT7eYHRDKy66op9ikEp+erDkmCBnwLAtWCefFcvnTixy+0NMleBams3w8V7oDYWF9PgSQ6uv5s5zw8I7LM8X0tf9DPRCLZX3vI5n2iYFE=
  - secure: StqyXNT7jDFU1YEbEAMrJl77arQNHJW74EyPFQx8FvEy/LSolF+fBHH7kRfG1sS1KnalwFFl2Do9D7G3XRaJIiuPopALiKPn6gQmUxpeqOvtn75n5d6I7Ldvh/JgWLNUT3n/MDhcp5Vkxuer1GSnDKbqQaQQH7tzVrM0flcW1bsPn3Xi30L4R9pXFLNCYrUEsdobnGxQfPU0xfqtnPHffykMdc30PPwU0j6gaaIwnQucbwB2/ogJe0fi/nJwspaGHkN6Mzkd1G84TepPRxLdoFL58Gg4KRVbW+UGKRiaosE/EfPEeGz8Hi9jjWKrz0T4wRW24xPdUSFcZfZGZ8j8P1hEDNzWKKCzyQa+Y+cVT2LrW21XtCoa68x1MXgS4OrPw/O8q5Z8bZieXYoZkIHg3yF0SE+2W5gFjIlkvyOlHT2SD4NjLnk6ZzSGMgWcJJgpZRS4sVSeqvj0D9g2DZKwHT02ZDQk+Z0HKbJctQjZ7tpI+vWMxwPHty6A/IKNh9J9S7BnkvZvzI+KVcjWMEmmdmeVSwedG6MZJNL2A2P1epm5y2U8EmldEMbPZKT1Gj0AXLcmeBW6Hei8HjF6JAq28b1zI8r4BpbQw3gPOvvWrOlWPoJwTwtCt753+7PHDTX2SYNdrh/ujaCnq3EEc4ylqVlQ/RHbaJDpPQ6X/K+nVYU=
  - secure: gMyaYcRKOA728jWs/fZbMFhf8JwGfWnJ8qNrRicOGgk9s8FFs8TMjvhWoK0xBn0frQja1BATg5AqbA9/cQ4xfssyvUr8KI354ulzwhWdW5VIVGl9GikOBVDCmpGWXZOZwikdrlt/JIUia+Fv8jCpWQ9+uaUV5qASHgr5cg+fAHHq8ilfRTR2s6ORHqMEVdawYQ5YhHRnHOzj7LHDnQ/JJqPW0/FEO0G604KxrilOMu4f5MQVix3RRQNNabTkzN56KrxQwlAuotZk1J2tZyCXDN8pur3qEWT+fG5E9knKw2vxExDS063OiZTe/rZHxIsFlqJMRMBiMssrfJ1v2yoL2aEakepKiKYnvlAoFKH8A5mu+D4YEWvXRFnYBPg8cLgCwovU6Z6oi0lh82Kqsv5d4LLUbh95ySitOCU8L/gQKk2kNREY0awuNTy29NXQYMzQNUmX+aQEo5/xPz0uZXXlGZRrrFCyzIGo9Cgjhmdtu4StoH0IDQNBiYPUM9T32j4S2oS9rpvpjaSUOgi5DIxreVfz9LdsxDRShajP48JlOz+Bv0dj4VL/Xe4jZbdCg2j+FtbES7rGmNhXKABT6GxGdOcggyoWVhn2nLPfKJSZjO+r7EdQowvRprl6GR22Iv0uKFaMO3ipb8ARavA4bRJvi52+9doALBvNDYhwQh34pE0=
